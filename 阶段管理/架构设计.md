# 游戏架构设计

## 整体架构

### 场景系统
- **LevelScene (基础场景类)**
  - 提供通用的场景功能：地面创建、玩家控制、碰撞检测
  - 管理关卡数据的加载与保存
  - 负责UI元素的基础显示
  
- **Level1Scene、Level2Scene (具体关卡)**
  - 继承自LevelScene
  - 定义关卡特有的属性：背景色、布局、玩家起始位置
  - 实现关卡特有的交互逻辑

### 数据管理
- **JSON数据存储**
  - 关卡数据保存在`data/levels.json`文件中
  - 包含平台位置、传送门设置、场景属性等配置
  - 支持从JSON动态构建关卡

- **LevelLoader (加载工具)**
  - 单例模式实现
  - 负责JSON数据的读取和解析
  - 提供数据到场景的映射功能

### 实体系统
- **Player (玩家实体)**
  - 继承自Phaser.Physics.Arcade.Sprite
  - 集成移动控制和物理属性
  - 支持键盘输入（方向键和WASD）
  - 实现跳跃、加速等核心移动功能

- **Platform (平台实体)**
  - 可自定义尺寸、颜色和物理属性
  - 支持运行时修改（调整大小、开关物理碰撞）
  - 序列化支持（toJSON/fromJSON）

- **Portal (传送门实体)**
  - 负责关卡间的切换
  - 支持定义目标场景
  - 包含视觉效果（粒子系统）

### 编辑器系统
- **LevelEditor (关卡编辑器)**
  - 内置于游戏中，通过按键E激活
  - 提供直观的平台创建与编辑界面
  - 支持摄像机控制、对象拖放
  - 实时预览与即时保存功能

## 前后端设计
- **当前阶段**
  - 纯前端实现，数据保存在localStorage
  - 使用单一客户端进行游戏体验和编辑
  
- **未来规划**
  - **游戏客户端**：专注于游戏体验
  - **编辑器客户端**：用于地图设计
  - **后端服务**：提供API接口，物理存储地图数据
  - 编辑内容通过API同步到后端修改JSON文件

## 技术实现
- **引擎**: Phaser 3 + TypeScript
- **渲染**: WebGL (主要) / Canvas (后备)
- **物理系统**: Arcade Physics
- **构建工具**: Webpack
- **资源管理**: 运行时生成 + 图像资源

## 开发流程
1. **地图设计**: 使用编辑器创建基础布局
2. **逻辑实现**: 编码实现各实体的交互逻辑
3. **数据序列化**: 保存关卡数据到JSON
4. **加载构建**: 运行时动态构建关卡
5. **迭代完善**: 通过编辑器实时调整设计
